# ADR-0006: Harden `pptx_to_img.py` conversion and validate dependencies

## Status
Accepted

## Context

Finding FND-007 highlights reliance on the external `soffice` binary. Research
note FND-007 explains that python‑pptx cannot render slides and that
LibreOffice is necessary for conversion【911142328886455†L234-L256】. It
recommends verifying that `soffice` is available and handling errors
gracefully.

## Decision

We will enhance `pptx_to_img.py` to validate the presence of `soffice` using
`shutil.which`. If not found, the script will raise a descriptive error
instructing the user to install LibreOffice or use a manual conversion. The
call to `subprocess.run` will be wrapped in a try/except block to capture and
report errors. We will add input validation for file paths.

## Consequences

* The script provides clearer feedback when dependencies are missing.
* Conversion still relies on LibreOffice, but failure modes are explicit.
* Future improvements (e.g., commercial converters) can be added behind
  feature flags.

## Rollback Plan

Revert the script to its previous version without validation and error
handling.

## References

* Finding: FND-007
* Plan ID: PLAN-006
* Research: research/FND-007.md