# FND-007 – Research: External binary invocation in `pptx_to_img.py`

## Problem capsule

The Python script `pptx_to_img.py` invokes the `soffice` (LibreOffice) binary via
`subprocess.run` to convert PPTX files to PDFs and then images. This dependency
may not be available on all environments, leading to runtime failures. We need
to validate this dependency and explore alternatives.

## Goals / NFRs

* Ensure the conversion process fails gracefully when `soffice` is absent.
* Reduce reliance on external GUI applications where possible.
* Maintain output fidelity and support headless operation.
* Keep licensing considerations in mind.

## Options comparison

| Option | Version / Recency | Pros | Cons | Risks | Migration path |
| --- | --- | --- | --- | --- | --- |
| **Validate `soffice` and handle errors gracefully** | LibreOffice 7.x (commonly installed in CI images) | Simple and retains the existing conversion workflow. We can check for `soffice` using Python’s `shutil.which` and produce a clear error message. | Still depends on LibreOffice; conversion is slow and resource‑heavy【911142328886455†L234-L256】. | Medium: still reliant on external binary; failure if not installed. | Modify the script to check for `soffice` presence; wrap `subprocess.run` in try/except and provide informative messages. |
| **Use commercial library such as Aspose.Slides** | Aspose.Slides for Python 2025 | Converts PPTX directly to images without external binaries; reliable and high fidelity. | Proprietary and requires a paid license; increases project cost. | Low (if licensed). | Purchase license, integrate library, and call conversion API in the script. |
| **Attempt pure Python conversion using `python-pptx`** | python‑pptx 1.0.0 | No external binary; open source. | Not possible: the `python‑pptx` library does not render slides to images; the project maintainer states that “python‑pptx doesn’t render the slides so can’t do this”【911142328886455†L234-L256】. | High: would require rendering code not supported by the library. | Not feasible. |
| **Remove automatic conversion and require users to convert manually** | n/a | Eliminates dependency and complexity. | Decreases usability; manual step for users. | Low. | Document manual conversion process instead of automation. |

## Preferred option

Retain the existing LibreOffice conversion but harden the script: use
`shutil.which` to verify that `soffice` is installed and raise a clear error
if not. Wrap the `subprocess.run` call to catch errors. Document that
LibreOffice is required and consider commercial alternatives (e.g., Aspose.Slides)
for future improvements. Python‑pptx cannot render slides to images【911142328886455†L234-L256】,
so it is not viable.